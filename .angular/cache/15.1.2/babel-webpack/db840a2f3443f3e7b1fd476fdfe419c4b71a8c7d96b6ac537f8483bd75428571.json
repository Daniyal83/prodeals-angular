{"ast":null,"code":"import { __decorate, __metadata } from \"tslib\";\nimport { ProductService } from '../../../services/product.service';\nimport { Router } from '@angular/router';\nimport { ActivatedRoute } from '@angular/router';\nimport { Store } from '@ngrx/store';\nimport * as ProductStore from 'app/store';\nimport { getProductStateBrandFilter, getProductStateCategoryFilter, getProductStatePage } from 'app/store';\nimport { offersAnimation } from 'app/animations';\nimport { computed } from 'mobx-angular';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../services/product.service\";\nimport * as i2 from \"@ngrx/store\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"ngx-pagination\";\nimport * as i6 from \"../../product/product.component\";\nimport * as i7 from \"../../buttons/button/button.component\";\nfunction OffersComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 8);\n    i0.ɵɵelement(1, \"app-product\", 9);\n    i0.ɵɵelementStart(2, \"div\", 10)(3, \"app-button\", 11);\n    i0.ɵɵlistener(\"clicked\", function OffersComponent_div_2_Template_app_button_clicked_3_listener($event) {\n      var restoredCtx = i0.ɵɵrestoreView(_r5);\n      var product_r3 = restoredCtx.$implicit;\n      var ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.showDetails($event, product_r3));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"app-button\", 11);\n    i0.ɵɵlistener(\"clicked\", function OffersComponent_div_2_Template_app_button_clicked_4_listener($event) {\n      var restoredCtx = i0.ɵɵrestoreView(_r5);\n      var product_r3 = restoredCtx.$implicit;\n      var ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.goToStore($event, product_r3));\n    });\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    var product_r3 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"product\", product_r3);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"buttonValue\", \"\\u041E \\u0442\\u043E\\u0432\\u0430\\u0440\\u0435\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"buttonValue\", \"\\u0412 \\u043C\\u0430\\u0433\\u0430\\u0437\\u0438\\u043D =>\");\n  }\n}\nfunction OffersComponent_div_5_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"titlecase\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    var brandFilter_r9 = ctx.ngIf;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \\u0412 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0439 \\u043C\\u043E\\u043C\\u0435\\u043D\\u0442 \\u043F\\u0440\\u043E\\u0434\\u0443\\u043A\\u0442\\u044B \\u0431\\u0440\\u044D\\u043D\\u0434\\u0430 \", i0.ɵɵpipeBind1(2, 1, brandFilter_r9), \" \\u043D\\u0435 \\u043F\\u0440\\u0435\\u0434\\u0441\\u0442\\u0430\\u0432\\u043B\\u0435\\u043D\\u044B \\u043D\\u0430 \\u043D\\u0430\\u0448\\u0435\\u043C \\u0441\\u0430\\u0439\\u0442\\u0435. \");\n  }\n}\nfunction OffersComponent_div_5_span_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"titlecase\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    var categoryFilter_r10 = ctx.ngIf;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \\u0412 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0439 \\u043C\\u043E\\u043C\\u0435\\u043D\\u0442 \\u043F\\u0440\\u043E\\u0434\\u0443\\u043A\\u0442\\u044B \\u0438\\u0437 \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0438 \", i0.ɵɵpipeBind1(2, 1, categoryFilter_r10), \" \\u043D\\u0435 \\u043F\\u0440\\u0435\\u0434\\u0441\\u0442\\u0430\\u0432\\u043B\\u0435\\u043D\\u044B \\u043D\\u0430 \\u043D\\u0430\\u0448\\u0435\\u043C \\u0441\\u0430\\u0439\\u0442\\u0435. \");\n  }\n}\nfunction OffersComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 12);\n    i0.ɵɵtemplate(1, OffersComponent_div_5_span_1_Template, 3, 3, \"span\", 13);\n    i0.ɵɵpipe(2, \"async\");\n    i0.ɵɵtemplate(3, OffersComponent_div_5_span_3_Template, 3, 3, \"span\", 13);\n    i0.ɵɵpipe(4, \"async\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    var ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(2, 2, ctx_r1.brandFilter));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(4, 4, ctx_r1.categoryFilter));\n  }\n}\nfunction OffersComponent_pagination_controls_6_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r12 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"pagination-controls\", 14);\n    i0.ɵɵlistener(\"pageChange\", function OffersComponent_pagination_controls_6_Template_pagination_controls_pageChange_0_listener($event) {\n      i0.ɵɵrestoreView(_r12);\n      var ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.pageChange($event));\n    });\n    i0.ɵɵelementEnd();\n  }\n}\nvar _c0 = function (a1) {\n  return {\n    itemsPerPage: 9,\n    currentPage: a1\n  };\n};\nvar OffersComponent = /** @class */function () {\n  function OffersComponent(productService, store, router, route) {\n    this.productService = productService;\n    this.store = store;\n    this.router = router;\n    this.route = route;\n    this.isReady = false;\n    this.products = [];\n    this.page = store.select(getProductStatePage);\n    this.brandFilter = store.select(getProductStateBrandFilter);\n    this.categoryFilter = store.select(getProductStateCategoryFilter);\n  }\n  Object.defineProperty(OffersComponent.prototype, \"isEmpty\", {\n    get: function () {\n      return !this.products || !this.products.length;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  OffersComponent.prototype.pageChange = function (event) {\n    this.store.dispatch(new ProductStore.SetPage(event));\n    this.scrollToTop(1000);\n  };\n  OffersComponent.prototype.scrollToTop = function (scrollDuration) {\n    var cosParameter = window.scrollY / 2;\n    var scrollCount = 0;\n    var oldTimestamp = performance.now();\n    function step(newTimestamp) {\n      scrollCount += Math.PI / (scrollDuration / (newTimestamp - oldTimestamp));\n      if (scrollCount >= Math.PI) window.scrollTo(0, 0);\n      if (window.scrollY === 0) return;\n      window.scrollTo(0, Math.round(cosParameter + cosParameter * Math.cos(scrollCount)));\n      oldTimestamp = newTimestamp;\n      window.requestAnimationFrame(step);\n    }\n    window.requestAnimationFrame(step);\n  };\n  OffersComponent.prototype.toggle = function () {\n    this.isReady = !this.isReady;\n  };\n  OffersComponent.prototype.getAllProducts = function () {\n    var _this = this;\n    var brand, category;\n    var allProducts = this.productService.getProducts();\n    this.brandFilter.subscribe(function (res) {\n      brand = res;\n      _this.isReady = false;\n      setTimeout(function () {\n        _this.products = _this.getFilteredByBrandProducts(allProducts, res);\n        _this.isReady = true;\n      }, 200);\n    });\n    this.categoryFilter.subscribe(function (res) {\n      category = res;\n      if (res) {\n        _this.isReady = false;\n        setTimeout(function () {\n          _this.products = _this.getFilteredByCategoryProducts(allProducts, res);\n          _this.isReady = true;\n        }, 200);\n      }\n    });\n    if (!brand && !category) {\n      this.router.navigate(['/main']);\n    }\n  };\n  OffersComponent.prototype.getFilteredByBrandProducts = function (arr, filter) {\n    return arr.filter(function (item) {\n      return item.brand.toLowerCase().indexOf(filter) !== -1;\n    });\n  };\n  OffersComponent.prototype.getFilteredByCategoryProducts = function (arr, filter) {\n    return arr.filter(function (item) {\n      return item.rusCategory.toLowerCase().indexOf(filter) !== -1;\n    });\n  };\n  OffersComponent.prototype.setDefaultFilters = function () {\n    if (!this.route.snapshot.params.filter) {\n      this.store.dispatch(new ProductStore.SetBrandFilter(\"\"));\n      this.store.dispatch(new ProductStore.SetCategoryFilter(\"\"));\n    }\n  };\n  OffersComponent.prototype.showDetails = function (value, product) {\n    this.store.dispatch(new ProductStore.SetProductDetails(product));\n    this.router.navigate([\"/product-details/\".concat(product.title.replace(/[\\/ ]/g, \"_\"))]);\n  };\n  OffersComponent.prototype.goToStore = function (value, product) {\n    window.open(product.href, '_blank');\n  };\n  OffersComponent.prototype.ngOnInit = function () {\n    this.setDefaultFilters();\n    this.getAllProducts();\n  };\n  OffersComponent.ɵfac = function OffersComponent_Factory(t) {\n    return new (t || OffersComponent)(i0.ɵɵdirectiveInject(i1.ProductService), i0.ɵɵdirectiveInject(i2.Store), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i3.ActivatedRoute));\n  };\n  OffersComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: OffersComponent,\n    selectors: [[\"app-offers\"]],\n    decls: 10,\n    vars: 11,\n    consts: [[1, \"offers\"], [1, \"offers__products\"], [\"class\", \"offers__item\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"offers__empty\", 4, \"ngIf\"], [\"class\", \"offers__page-control\", \"previousLabel\", \"Prev\", 3, \"pageChange\", 4, \"ngIf\"], [1, \"offers__banner\"], [\"target\", \"_blank\", \"href\", \"https://alitems.com/g/1e8d11449443619d746e16525dc3e8/?ulp=https%3A%2F%2Ftmall.aliexpress.com%2Fru%2F__pc%2Fpages%2Fdailydeals-lp.htm%3Fspm%3Da2g0r.9334986.DailyDeals_banner.1.1d3b3d14BrXsse&subid=gorayschie-tovary-tmall-banner\", 1, \"offers__link\"], [\"src\", \"../../../../assets/images/banners/goryaschie-tovary-tmall.png\", \"alt\", \"iphone 11 sale start\", 1, \"offers__image\"], [1, \"offers__item\"], [3, \"product\"], [1, \"offers__buttons\"], [3, \"buttonValue\", \"clicked\"], [1, \"offers__empty\"], [4, \"ngIf\"], [\"previousLabel\", \"Prev\", 1, \"offers__page-control\", 3, \"pageChange\"]],\n    template: function OffersComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1);\n        i0.ɵɵtemplate(2, OffersComponent_div_2_Template, 5, 3, \"div\", 2);\n        i0.ɵɵpipe(3, \"paginate\");\n        i0.ɵɵpipe(4, \"async\");\n        i0.ɵɵtemplate(5, OffersComponent_div_5_Template, 5, 6, \"div\", 3);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(6, OffersComponent_pagination_controls_6_Template, 1, 0, \"pagination-controls\", 4);\n        i0.ɵɵelementStart(7, \"div\", 5)(8, \"a\", 6);\n        i0.ɵɵelement(9, \"img\", 7);\n        i0.ɵɵelementEnd()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"@fadeIn\", ctx.isReady ? \"show\" : \"hide\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind2(3, 4, ctx.products, i0.ɵɵpureFunction1(9, _c0, i0.ɵɵpipeBind1(4, 7, ctx.page))));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.isEmpty);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.isEmpty);\n      }\n    },\n    dependencies: [i4.NgForOf, i4.NgIf, i5.PaginationControlsComponent, i6.ProductComponent, i7.ButtonComponent, i4.AsyncPipe, i4.TitleCasePipe, i5.PaginatePipe],\n    styles: [\".offers[_ngcontent-%COMP%]{display:flex;flex-direction:column}.offers__products[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-evenly}.offers__buttons[_ngcontent-%COMP%]{margin:5px 0 20px;display:flex;justify-content:space-around}.offers__empty[_ngcontent-%COMP%]{margin-top:10px;padding:20px;width:100%;background-color:#6c757d;color:#fff;border-radius:5px}.offers__image[_ngcontent-%COMP%]{width:100%}\"],\n    data: {\n      animation: [offersAnimation]\n    }\n  });\n  __decorate([computed, __metadata(\"design:type\", Object), __metadata(\"design:paramtypes\", [])], OffersComponent.prototype, \"isEmpty\", null);\n  return OffersComponent;\n}();\nexport { OffersComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}